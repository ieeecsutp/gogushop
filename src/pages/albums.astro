---
// FeaturedProducts.astro

const featuredAlbums = [
  {
    id: 1,
    title: 'Map of the Soul: 7',
    artist: 'BTS',
    year: '2020',
    image: 'https://images.unsplash.com/photo-1614613535308-eb5fbd3d2c17?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'BESTSELLER',
    badgeColor: 'bg-primary',
    rating: 4.9,
    reviews: 2847,
    description: 'El álbum más icónico que redefinió el K-Pop mundial',
    tracks: ['ON', 'Black Swan', 'My Time'],
    color: 'from-purple-500 to-pink-500'
  },
  {
    id: 2,
    title: 'DIMENSION: DILEMMA',
    artist: 'ENHYPEN',
    year: '2021',
    image: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'HOT',
    badgeColor: 'bg-secondary',
    rating: 4.8,
    reviews: 1923,
    description: 'La evolución musical de los ídolos de nueva generación',
    tracks: ['Tamed-Dashed', 'Upper Side Dreamin', 'Go Big or Go Home'],
    color: 'from-blue-500 to-cyan-500'
  },
  {
    id: 3,
    title: 'The Chaos Chapter: FREEZE',
    artist: 'TOMORROW X TOGETHER',
    year: '2021',
    image: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'NUEVO',
    badgeColor: 'bg-accent',
    rating: 4.7,
    reviews: 1534,
    description: 'Explosión de energía juvenil y sonidos experimentales',
    tracks: ['0X1=LOVESONG', 'Anti-Romantic', 'Magic'],
    color: 'from-green-500 to-teal-500'
  },
  {
    id: 4,
    title: 'Formula of Love: O+T=<3',
    artist: 'TWICE',
    year: '2021',
    image: 'https://images.unsplash.com/photo-1667013755556-683e463d72cc?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'POPULAR',
    badgeColor: 'bg-pink-500',
    rating: 4.9,
    reviews: 2456,
    description: 'La fórmula perfecta del amor en melodías adictivas',
    tracks: ['Scientist', 'Moonlight', 'ICON'],
    color: 'from-pink-500 to-rose-500'
  },
  {
    id: 5,
    title: 'LOVE DIVE',
    artist: 'IVE',
    year: '2022',
    image: 'https://images.unsplash.com/photo-1676068368612-1c8b3e2afed0?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'VIRAL',
    badgeColor: 'bg-orange-500',
    rating: 4.8,
    reviews: 1789,
    description: 'El fenómeno viral que conquistó las plataformas',
    tracks: ['LOVE DIVE', 'ROYAL', 'TAKE IT'],
    color: 'from-orange-500 to-red-500'
  },
  {
    id: 6,
    title: 'FEARLESS',
    artist: 'LE SSERAFIM',
    year: '2022',
    image: 'https://images.unsplash.com/photo-1736348866103-85fb334ae994?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=600',
    badge: 'DEBUT',
    badgeColor: 'bg-indigo-500',
    rating: 4.7,
    reviews: 1234,
    description: 'El debut más esperado del año con actitud sin miedo',
    tracks: ['FEARLESS', 'Blue Flame', 'The Great Mermaid'],
    color: 'from-indigo-500 to-purple-500'
  }
];
---

<section class="py-20 bg-gradient-to-b from-background to-muted/30">
  <div class="container mx-auto px-4">
    <div class="text-center mb-16">
      <div class="badge-featured bg-gradient-to-r from-primary to-accent text-white px-4 py-2 mb-4 inline-flex items-center rounded-es-sm">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
          <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>
        </svg>
        Los Favoritos de Nuestros Fans
      </div>
      
      <h2 class="text-4xl md:text-5xl font-bold mb-6">
       <span class="bg-gradient-to-r from-orange-500 via-fuchsia-500 to-yellow-300 bg-clip-text text-transparent">
         Álbumes Más Populares
        </span>
      </h2>
      
      <p class="text-xl text-muted-foreground max-w-3xl mx-auto">
        Los álbumes que están dominando las listas de reproducción de los fans. 
        Descubre la música que está definiendo el K-Pop actual.
      </p>
    </div>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
      {featuredAlbums.map((album) => (
        <div 
          class="album-card border-2 border-primary/10 hover:border-primary/30 transition-all duration-500 hover:shadow-2xl hover:-translate-y-3 group overflow-hidden rounded-xl bg-white"
          data-album-id={album.id}
        >
          <div class="relative h-[60vh] min-h-96 overflow-hidden">
            <img
              src={album.image}
              alt={`${album.artist} - ${album.title}`}
              class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
              loading="lazy"
            />
            
            <!-- Gradient Overlay -->
            <div class={`absolute inset-0 bg-gradient-to-t ${album.color} opacity-20 group-hover:opacity-40 transition-opacity duration-500`}></div>
            
            <!-- Badge -->
            <div class={`absolute top-4 left-4 ${album.badgeColor} text-white px-3 py-1 font-bold rounded-full text-sm`}>
              {album.badge}
            </div>
            
            <!-- Favorite Button -->
            <button
              class="favorite-btn absolute top-4 right-4 bg-white/90 hover:bg-white border border-white/50 hover:border-white transition-all duration-300 rounded-lg p-2"
              data-album-id={album.id}
              aria-label="Add to favorites"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="heart-icon text-muted-foreground transition-colors duration-300">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
              </svg>
            </button>

            <!-- Play Button Overlay -->
            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <button
                class="play-btn rounded-full w-20 h-20 bg-white/90 hover:bg-white text-primary shadow-xl backdrop-blur-sm transition-all"
                data-album-id={album.id}
                aria-label="Play preview"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="play-icon mx-auto">
                  <polygon points="6 3 20 12 6 21 6 3"/>
                </svg>
              </button>
            </div>

            <!-- Artist Name Overlay -->
            <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent p-6">
              <h3 class="text-3xl font-bold text-white mb-2 tracking-wide">
                {album.artist}
              </h3>
              <h4 class="text-xl text-white/90 font-medium mb-2">
                {album.title}
              </h4>
              <p class="text-white/70 text-sm">
                {album.year} • {album.tracks.length} tracks
              </p>
            </div>
          </div>
          
          <div class="p-6">
            <!-- Description -->
            <p class="text-muted-foreground mb-4 leading-relaxed">
              {album.description}
            </p>

            <!-- Popular Tracks -->
            <div class="mb-4">
              <h5 class="font-bold text-sm text-primary mb-2 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                  <path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/>
                </svg>
                Tracks Populares:
              </h5>
              <div class="flex flex-wrap gap-1">
                {album.tracks.map((track) => (
                  <span class="text-xs border border-primary/20 text-primary/80 hover:bg-primary/10 transition-colors px-2 py-1 rounded-full">
                    {track}
                  </span>
                ))}
              </div>
            </div>

            <!-- Rating -->
            <div class="flex items-center space-x-2 mb-4">
              <div class="flex">
                {[...Array(5)].map((_, i) => (
                  <svg data-index={i} xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill={i < Math.floor(album.rating) ? "currentColor" : "none"} stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class={i < Math.floor(album.rating) ? 'text-secondary' : 'text-muted-foreground/30'}>
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                  </svg>
                ))}
              </div>
              <span class="font-bold text-foreground">{album.rating}</span>
              <span class="text-sm text-muted-foreground">
                ({album.reviews.toLocaleString()} fans)
              </span>
            </div>

            <!-- Action Buttons -->
            <div class="space-y-3">
              <button 
    class="btn-add-collection w-full bg-gradient-to-r from-purple-600 to-cyan-500 hover:from-purple-500 hover:to-cyan-400 text-white py-3 rounded-xl transition-all duration-300 transform hover:scale-105 inline-flex items-center justify-center"
>
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 vinyl-spin">
        <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/>
    </svg>
    Agregar a Colección
</button>

              <button 
                class="btn-view-details w-full border-2 border-primary/20 text-primary hover:bg-primary/10 py-3 rounded-xl transition-all duration-300 inline-flex items-center justify-center bg-transparent"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                  <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
                </svg>
                Ver Detalles del Álbum
              </button>
            </div>
          </div>
        </div>
      ))}
    </div>

    <!-- Limited Time Offer -->
   <div class="mt-16 text-center">
    <div class="max-w-4xl mx-auto bg-white/50 backdrop-blur-sm shadow-xl rounded-2xl border border-gray-100">
        <div class="p-8">
            <div class="flex items-center justify-center mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-violet-600 mr-3">
                    <path d="M10 2h4"/><path d="M12 14v-4"/><path d="M4 13a8 8 0 0 1 8-7 8 8 0 1 1-5.3 14L4 17.6"/><path d="M9 17H2v7"/>
                </svg>
                <h3 class="text-2xl font-bold text-violet-600">¡Oferta por Tiempo Limitado!</h3>
            </div>
            
            <p class="text-lg text-gray-600 mb-6">
                Lleva <span class="font-bold text-violet-600">3 álbumes por solo 2</span> + 
                <span class="font-bold text-pink-500"> photocards exclusivas gratis</span> en cada pedido.
            </p>
            
            <div class="flex justify-center space-x-4 mb-6">
                <div class="text-center">
                    <div class="bg-violet-600 text-white rounded-lg px-4 py-2 font-bold text-xl shadow-md">23</div>
                    <p class="text-sm text-gray-500 mt-1">Horas</p>
                </div>
                <div class="text-center">
                    <div class="bg-pink-500 text-white rounded-lg px-4 py-2 font-bold text-xl shadow-md">45</div>
                    <p class="text-sm text-gray-500 mt-1">Minutos</p>
                </div>
                <div class="text-center">
                    <div class="bg-cyan-500 text-white rounded-lg px-4 py-2 font-bold text-xl shadow-md">12</div>
                    <p class="text-sm text-gray-500 mt-1">Segundos</p>
                </div>
            </div>
            
            <button 
                class="btn-view-all bg-gradient-to-r from-violet-600 to-cyan-500 hover:from-violet-500 hover:to-cyan-400 text-white px-8 py-4 text-lg rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 inline-flex items-center"
            >
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                    <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/>
                </svg>
                Ver Todos los Álbumes
            </button>
        </div>
    </div>
</div>
  </div>
</section>

<script>
  // State management
  let favorites: number[] = [];
  let playingAlbum: number | null = null;

  // Favorite functionality
  const favoriteButtons = document.querySelectorAll('.favorite-btn');
  favoriteButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const albumId = parseInt(btn.getAttribute('data-album-id') || '0');
      const heartIcon = btn.querySelector('.heart-icon');
      
      if (favorites.includes(albumId)) {
        favorites = favorites.filter(id => id !== albumId);
        heartIcon?.classList.remove('fill-primary', 'text-primary');
        heartIcon?.classList.add('text-muted-foreground');
      } else {
        favorites.push(albumId);
        heartIcon?.classList.add('fill-primary', 'text-primary');
        heartIcon?.classList.remove('text-muted-foreground');
      }
    });
  });

  // Play functionality
  const playButtons = document.querySelectorAll('.play-btn');
  playButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const albumId = parseInt(btn.getAttribute('data-album-id') || '0');
      const playIcon = btn.querySelector('.play-icon');
      
      if (playingAlbum === albumId) {
        playingAlbum = null;
        btn.classList.remove('bg-secondary');
        btn.classList.add('bg-white/90');
        if (playIcon) {
          playIcon.innerHTML = '<polygon points="6 3 20 12 6 21 6 3"/>';
        }
      } else {
        // Reset all other playing buttons
        playButtons.forEach(otherBtn => {
          const otherIcon = otherBtn.querySelector('.play-icon');
          otherBtn.classList.remove('bg-secondary');
          otherBtn.classList.add('bg-white/90');
          if (otherIcon) {
            otherIcon.innerHTML = '<polygon points="6 3 20 12 6 21 6 3"/>';
          }
        });
        
        playingAlbum = albumId;
        btn.classList.add('bg-secondary');
        btn.classList.remove('bg-white/90');
        if (playIcon) {
          playIcon.innerHTML = '<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>';
        }
      }
    });
  });
</script>

<style>
  /* Custom colors */
  :root {
    --primary: #667eea;
    --secondary: #764ba2;
    --accent: #f093fb;
    --muted: #6b7280;
    --muted-foreground: #9ca3af;
    --foreground: #1f2937;
    --background: #ffffff;
  }

  .bg-primary {
    background-color: var(--primary);
  }

  .bg-secondary {
    background-color: var(--secondary);
  }

  .bg-accent {
    background-color: var(--accent);
  }

  .bg-pink-500 {
    background-color: #ec4899;
  }

  .bg-orange-500 {
    background-color: #f97316;
  }

  .bg-indigo-500 {
    background-color: #6366f1;
  }

  .text-primary {
    color: var(--primary);
  }

  .text-secondary {
    color: var(--secondary);
  }

  .text-muted-foreground {
    color: var(--muted-foreground);
  }

  .text-foreground {
    color: var(--foreground);
  }

  .border-primary\/10 {
    border-color: rgba(102, 126, 234, 0.1);
  }

  .border-primary\/20 {
    border-color: rgba(102, 126, 234, 0.2);
  }

  .border-primary\/30 {
    border-color: rgba(102, 126, 234, 0.3);
  }

  .bg-primary\/10 {
    background-color: rgba(102, 126, 234, 0.1);
  }

  .to-muted\/30 {
    --tw-gradient-to: rgba(107, 115, 128, 0.3);
  }

  /* Gradient backgrounds */
  .from-purple-500 { --tw-gradient-from: #a855f7; }
  .to-pink-500 { --tw-gradient-to: #ec4899; }
  .from-blue-500 { --tw-gradient-from: #3b82f6; }
  .to-cyan-500 { --tw-gradient-to: #06b6d4; }
  .from-green-500 { --tw-gradient-from: #22c55e; }
  .to-teal-500 { --tw-gradient-to: #14b8a6; }
  .from-pink-500 { --tw-gradient-from: #ec4899; }
  .to-rose-500 { --tw-gradient-to: #f43f5e; }
  .from-orange-500 { --tw-gradient-from: #f97316; }
  .to-red-500 { --tw-gradient-to: #ef4444; }
  .from-indigo-500 { --tw-gradient-from: #6366f1; }
  .to-purple-500 { --tw-gradient-to: #a855f7; }

  /* Badge featured */
  .badge-featured {
    background: linear-gradient(135deg, var(--primary), var(--accent));
    font-size: 0.875rem;
    font-weight: 600;
  }

  /* Vinyl spin animation */
  .vinyl-spin {
    animation: spin 3s linear infinite;
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  /* Album card hover effect */
  .album-card {
    position: relative;
  }

  /* Heart icon filled state */
  .heart-icon.fill-primary {
    fill: var(--primary);
  }

  /* Shadow utilities */
  .shadow-2xl {
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }

  .shadow-xl {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .shadow-lg {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  /* Button styles */
  button {
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  /* Smooth transitions */
  .album-card,
  .favorite-btn,
  .play-btn,
  .btn-add-collection,
  .btn-view-details,
  .btn-view-all {
    transition: all 0.3s ease;
  }
</style>